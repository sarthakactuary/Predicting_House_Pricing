setwd("E:/Project of Coding/R_Language")
HousePrice <- read.csv("data.csv")
setwd
setwd()
getwd()
setwd("E:\\Project of Coding\\R_Language\\Predicting-House-Pricing")
HousePrice <- read.csv("data.csv")
HousePrice <- read.csv("data.csv")
HousePrice <- read.csv("data.csv")
head(HousePrice)
HousePrice <- read.csv("data.csv")
colnames(HousePrice)
colSums(is.na(HousePrice))
sapply(HousePrice, is.numeric)
rm(data)
rm(HousePrice)
HousePrice <- read.csv("data.csv")
head(HousePrice)
colnames(HousePrice)
colSums(is.na(HousePrice))
sapply(HousePrice, is.numeric)
colSums(HousePrice==0)
HousePrice <- subset(HousePrice, bedrooms!=0 & bathrooms!=0)
HousePrice$price[HousePrice$price==0] <- median(HousePrice$price)
sum(HousePrice$sqft_living)==sum(HousePrice$sqft_above+HousePrice$sqft_basement)
summary(HousePrice)
colSums(HousePrice==0)
library(dplyr)
HousePrice %>%
group_by(view) %>%
summarise(median_price = median(price))
HousePrice %>%
group_by(condition) %>%
summarise(median_price=median(price))
hist(HousePrice$price,breaks = 50, main = "Price Distribution", xlab="Price",prob = TRUE)
lines(density(HousePrice$price),col="blue",lwd=2)
install.packages("e1071")
library(e1071)
skewness(HousePrice$price)
boxplot(HousePrice$price, horizontal = TRUE, main="Boxplot of Price")
library(ggplot2)
ggplot(HousePrice, aes(x=price))+
geom_histogram(bins=30,fill="skyblue")+
labs(title="Distribution of price")+
theme_minimal()
ggplot(HousePrice, aes(x=price))+
boxplot()+
labs(title="price")
ggplot(HousePrice, aes(x=price))+
geom_boxplot(fill="skyblue")+
labs(title="price",ylab="Price")+
theme_minimal()
ggplot(HousePrice, aes(y=price))+
geom_boxplot(fill="skyblue")+
labs(title="price",ylab="Price")+
theme_minimal()
ggplot(HousePrice, aes(x=price))+
geom_boxplot(fill="skyblue")+
labs(title="price",ylab="Price")+
theme_minimal()
install.packages("tidyr")
library(tidyr)
data_long <- pivot_longer(
HousePrice,
cols = c(price, sqft_living, sqft_lot),
names_to = "Variable",
values_to = "Value"
)
View(data_long)
ggplot(data_long, aes(x = Variable, y = Value)) +
geom_boxplot(fill = "orchid") +
labs(title = "Boxplots of Multiple Variables",
y = "Value") +
theme_minimal()
ggplot(HousePrice, aes(x = factor(bedrooms), y = price)) +
geom_boxplot(fill = "tomato") +
labs(title = "Price by Number of Bedrooms",
x = "Bedrooms",
y = "Price") +
theme_minimal()
ggplot(HousePrice, aes(x = floor, y = price)) +
geom_boxplot(fill = "tomato") +
labs(title = "Price by Number of Bedrooms",
x = "Bedrooms",
y = "Price") +
theme_minimal()
ggplot(HousePrice, aes(x = floors, y = price)) +
geom_boxplot(fill = "tomato") +
labs(title = "Price by Number of Bedrooms",
x = "Bedrooms",
y = "Price") +
theme_minimal()
ggplot(HousePrice, aes(x = factor(floors), y = price)) +
geom_boxplot(fill = "tomato") +
labs(title = "Price by Number of Bedrooms",
x = "Bedrooms",
y = "Price") +
theme_minimal()
ggplot(HousePrice, aes(x=price))+
geom_histogram(bins=30,fill="skyblue")+
labs(title="Distribution of price")+
theme_minimal()
ggplot(HousePrice, aes(x=price))+
geom_histogram(bins=50,fill="darkgreen")+
labs(title="Distribution of price")+
theme_minimal()
ggplot(HousePrice, aes(x=log(price))+
ggplot(HousePrice, aes(x=log(price)))+
geom_histogram(bins=50,fill="darkgreen")+
labs(title="Distribution of price")+
theme_minimal()
ggplot(HousePrice, aes(x=log(price)))+
ggplot(HousePrice, aes(x=log(price)))+
geom_histogram(bins=50,fill="darkgreen")+
labs(title="Distribution of price")+
theme_minimal()
install.packages("moments")
library(moments)
skewness(HousePrice$price)
skewness(log(HousePrice$price))
mean(HousePrice$price)>median(HousePrice$price)
#that mean's right skewed
HousePrice$view <- factor(HousePrice$view, ordered = TRUE)
HousePrice$condition <- factor(HousePrice$condition, ordered = TRUE)
HousePrice$waterfront <- factor(HousePrice$waterfront, ordered = TRUE)
summary(train_data)
summary(test_data)
sapply(HousePrice, function(x) length(unique(x)))
nearZeroVar(HousePrice, saveMetrics = TRUE)
cor(HousePrice[,sapply(HousePrice,is.numeric)])
library(moments)
skewness(HousePrice$price)
skewness(log(HousePrice$price))
mean(HousePrice$price)>median(HousePrice$price)
#that mean's right skewed
HousePrice$view <- factor(HousePrice$view, ordered = TRUE)
HousePrice$condition <- factor(HousePrice$condition, ordered = TRUE)
HousePrice$waterfront <- factor(HousePrice$waterfront, ordered = TRUE)
cor(HousePrice[,sapply(HousePrice,is.numeric)])
sapply(HousePrice, function(x) length(unique(x)))
nearZeroVar(HousePrice, saveMetrics = TRUE)
library(caret)
nearZeroVar(HousePrice, saveMetrics = TRUE)
library(dplyr)
sapply(HousePrice,n_distinct)
HousePrice <- read.csv("data.csv")
colSums(HousePrice==0)
HousePrice <- subset(HousePrice, bedrooms!=0 & bathrooms!=0)
HousePrice$price[HousePrice$price==0] <- median(HousePrice$price)
colSums(HousePrice==0)
sum(HousePrice$sqft_living)==sum(HousePrice$sqft_above+HousePrice$sqft_basement)
summary(HousePrice)
library(dplyr)
library(ggplot2)
library(tidyr)
library(moments)
#that mean's right skewed
HousePrice$view <- factor(HousePrice$view, ordered = TRUE)
HousePrice$condition <- factor(HousePrice$condition, ordered = TRUE)
HousePrice$city <- factor(HousePrice$city, ordered = TRUE)
HousePrice$statezip <- factor(HousePrice$statezip, ordered = TRUE)
library(caret)
nearZeroVar(HousePrice, saveMetrics = TRUE)
sapply(HousePrice,n_distinct)
HousePrice$price_bins <- cut(HousePrice$price,
breaks=quantile(HousePrice$price, probs = seq(0,1,0.1)),
include.lowest=TRUE)
set.seed(123)
split_index <- createDataPartition(HousePrice$price_bins,p=0.7,list = FALSE)
train_data <- HousePrice[split_index,]
test_data <- HousePrice[-split_index,]
summary(train_data)
summary(test_data)
str(train_data)
library(car)
model_lm1 <- lm(price~bedrooms+bathrooms+floors+sqft_lot+sqft_above+sqft_basement+yr_built,data=train_data)
vif(model_lm1)
summary(model_lm1)
cor(HousePrice[,sapply(HousePrice,is.numeric)])
#replace basement and above to living
model_lm2 <- lm(price~bedrooms+bathrooms+floors+sqft_lot+sqft_above+sqft_basement+yr_built,data=train_data)
summary(model_lm2)
#replace basement and above to living
model_lm2 <- lm(price~bedrooms+bathrooms+floors+sqft_lot+sqft_living+yr_built,data=train_data)
summary(model_lm2)
#removing sqft_lot terms
model_lm3 <- lm(price~bedrooms+bathrooms+floors+sqft_living+yr_built,data=train_data)
summary(model_lm3)
#adding interaction term
model_lm4 <- lm(price~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm4)
View(train_data)
#log(price)
model_lm5 <- lm(log(price)~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm5)
#apply log into model_lm2
model_lm2_log <- lm(log(price)~bedrooms+bathrooms+floors+sqft_lot+sqft_living+yr_built,data=train_data)
summary(model_lm2_log)
#adding sq ft_lot in log model
model_lm6 <- lm(log(price)~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm5)
summary(model_lm6)
#log(price)
model_lm5 <- lm(log(price)~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm5)
View(split_index)
#start with numeric variable
model_lm1 <- lm(price~bedrooms+bathrooms+floors+sqft_lot+sqft_above+sqft_basement+yr_built,data=train_data)
summary(model_lm1)
#replace basement and above to living
model_lm2 <- lm(price~bedrooms+bathrooms+floors+sqft_lot+sqft_living+yr_built,data=train_data)
summary(model_lm2)
#apply log into model_lm2
model_lm2_log <- lm(log(price)~bedrooms+bathrooms+floors+sqft_lot+sqft_living+yr_built,data=train_data)
summary(model_lm2_log)
#removing sq ft_lot terms
model_lm3 <- lm(price~bedrooms+bathrooms+floors+sqft_lot+sqft_living+yr_built,data=train_data)
summary(model_lm3)
#removing sq ft_lot terms
model_lm3 <- lm(price~bedrooms+bathrooms+floors+sqft_living+yr_built,data=train_data)
summary(model_lm3)
#adding interaction term
model_lm4 <- lm(price~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm4)
#log(price)
model_lm5 <- lm(log(price)~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm5)
#removing sq ft_lot in log model
model_lm6 <- lm(log(price)~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+yr_built+bathrooms:yr_built+floors+yr_built,data=train_data)
summary(model_lm6)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+bathrooms:floors+floors+bathrooms:yr_built+floors+sqft_lot+yr_built,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+floors+sqft_lot,data=train_data)
summary(model_lm7)
summary(model_lm7)
cor(HousePrice[,sapply(HousePrice,is.numeric)])
#adding and removing more changes
model_lm8 <- lm(bedrooms+bathrooms+sqft_living+sqft_lot+floors+yr_built+yr_renovated+bedrooms:bathrooms+bedrooms:sqft_living+bathrooms:sqft_living+bedrooms:bathrooms:sqft_living+bathrooms:yr_built)
#adding and removing more changes
model_lm8 <- lm(price~bedrooms+bathrooms+sqft_living+sqft_lot+floors+yr_built+yr_renovated+bedrooms:bathrooms+bedrooms:sqft_living+bathrooms:sqft_living+bedrooms:bathrooms:sqft_living+bathrooms:yr_built)
#adding and removing more changes
model_lm8 <- lm(price~bedrooms+bathrooms+sqft_living+sqft_lot+floors+yr_built+yr_renovated+bedrooms:bathrooms+bedrooms:sqft_living+bathrooms:sqft_living+bedrooms:bathrooms:sqft_living+bathrooms:yr_built,data=train_data)
summary(model_lm8)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(log(price)~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot+yr_built,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot+yr_renovated,data=train_data)
summary(model_lm7)
#changing some factors
model_lm7 <- lm(price~bedrooms*bathrooms*sqft_living+floors+bathrooms:yr_built+sqft_lot,data=train_data)
summary(model_lm7)
